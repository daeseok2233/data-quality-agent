/home/daeseok/dq-agent/src/dq_agent/quality.py:162: UserWarning: The argument 'infer_datetime_format' is deprecated and will be removed in a future version. A strict version of it is now the default, see https://pandas.pydata.org/pdeps/0004-consistent-to-datetime-parsing.html. You can safely remove this argument.
  parsed_date = pd.to_datetime(df["order_date"].astype(str), errors="coerce", infer_datetime_format=True)
{'has_file': True, 'message': '파일을 정상적으로 점검했습니다.', 'missing': {'total_rows': 12, 'total_columns': 7, 'missing_by_column': {'order_id': 0, 'order_date': 0, 'customer_id': 1, 'product_id': 0, 'quantity': 0, 'unit_price': 0, 'amount': 0}, 'missing_ratio_by_column': {'order_id': 0.0, 'order_date': 0.0, 'customer_id': 0.08333333333333333, 'product_id': 0.0, 'quantity': 0.0, 'unit_price': 0.0, 'amount': 0.0}}, 'outlier': {'method': 'iqr', 'iqr_multiplier': 1.5, 'outlier_count_by_column': {'quantity': 2, 'unit_price': 1, 'amount': 1}}, 'row_issues': {'missing': [{'order_id': 1004, 'order_date': '2025/10/25', 'customer_id': nan, 'product_id': 'P003', 'quantity': 5, 'unit_price': 50000, 'amount': 10, 'row_index': 3, 'missing_columns': ['customer_id']}], 'duplicates': [{'order_id': 1002, 'order_date': '2025-10-25', 'customer_id': 'C002', 'product_id': 'P002', 'quantity': 1, 'unit_price': 15000, 'amount': 15000, 'row_index': 1}, {'order_id': 1002, 'order_date': '2025-10-25', 'customer_id': 'C002', 'product_id': 'P002', 'quantity': 1, 'unit_price': 15000, 'amount': 15000, 'row_index': 10}], 'business_rule': [{'order_id': 1001, 'order_date': '2025-10-25', 'customer_id': 'C001', 'product_id': 'P001', 'quantity': 2, 'unit_price': 30000, 'amount': 60000, 'row_index': 0, 'issues': ['non_base_date']}, {'order_id': 1002, 'order_date': '2025-10-25', 'customer_id': 'C002', 'product_id': 'P002', 'quantity': 1, 'unit_price': 15000, 'amount': 15000, 'row_index': 1, 'issues': ['non_base_date']}, {'order_id': 1003, 'order_date': '2025-10-24', 'customer_id': 'C003', 'product_id': 'P001', 'quantity': 3, 'unit_price': 30000, 'amount': 90000, 'row_index': 2, 'issues': ['non_base_date']}, {'order_id': 1004, 'order_date': '2025/10/25', 'customer_id': nan, 'product_id': 'P003', 'quantity': 5, 'unit_price': 50000, 'amount': 10, 'row_index': 3, 'issues': ['amount != quantity * unit_price', 'invalid_date_format']}, {'order_id': 1005, 'order_date': '2025-12-31', 'customer_id': 'C005', 'product_id': 'P004', 'quantity': 1, 'unit_price': 40000, 'amount': 40000, 'row_index': 4, 'issues': ['non_base_date']}, {'order_id': 1006, 'order_date': '2024-01-01', 'customer_id': 'C006', 'product_id': 'P005', 'quantity': 1, 'unit_price': 10000, 'amount': 10000, 'row_index': 5, 'issues': ['non_base_date']}, {'order_id': 1007, 'order_date': '2025-10-25', 'customer_id': 'C007', 'product_id': 'P006', 'quantity': 0, 'unit_price': 25000, 'amount': 0, 'row_index': 6, 'issues': ['quantity <= 0', 'amount <= 0', 'non_base_date']}, {'order_id': 1008, 'order_date': '2025-10-25', 'customer_id': 'C008', 'product_id': 'P007', 'quantity': -1, 'unit_price': 25000, 'amount': -25000, 'row_index': 7, 'issues': ['quantity <= 0', 'amount <= 0', 'non_base_date']}, {'order_id': 1009, 'order_date': '2025-10-25', 'customer_id': 'C009', 'product_id': 'P008', 'quantity': 2, 'unit_price': 0, 'amount': 0, 'row_index': 8, 'issues': ['unit_price <= 0', 'amount <= 0', 'non_base_date']}, {'order_id': 1010, 'order_date': '2025-10-25', 'customer_id': 'C010', 'product_id': 'P009', 'quantity': 1, 'unit_price': 9999999, 'amount': 9999999, 'row_index': 9, 'issues': ['non_base_date']}, {'order_id': 1002, 'order_date': '2025-10-25', 'customer_id': 'C002', 'product_id': 'P002', 'quantity': 1, 'unit_price': 15000, 'amount': 15000, 'row_index': 10, 'issues': ['non_base_date']}, {'order_id': 1011, 'order_date': 'invalid_date', 'customer_id': 'C011', 'product_id': 'P010', 'quantity': 1, 'unit_price': 12000, 'amount': 12000, 'row_index': 11, 'issues': ['invalid_date_format']}]}}
